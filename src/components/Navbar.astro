---
import Container from "./Container.astro";
---
<nav class="nav" aria-label="Primary">
  <Container class="nav-inner">
    <a class="brand" href="/" aria-label="Home">
      <img src="/icons/logo.png" alt="Logo" class="logo" />
      <span>ZachScholz.com</span>
    </a>

    <div class="links">
      <a href="/">Home</a>
      <a href="/about">About</a>
      <a href="/research">Research</a>
    </div>

    <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme" title="Toggle theme">
      <!-- default icon; JS swaps -->
      <span class="icon" id="themeIcon"></span>
    </button>
  </Container>
</nav>

<script>
  // 2-state toggle (light/dark). No "auto".
  (function(){
    const root = document.documentElement;
    const btn = document.getElementById('themeToggle');
    const icon = document.getElementById('themeIcon');

    function setIcon(theme){
      icon.innerHTML = theme === 'light'
        // Sun
        ? '<svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" aria-hidden="true"><path d="M6.76 4.84l-1.8-1.79L3.17 4.84l1.79 1.79 1.8-1.79zM1 13h3v-2H1v2zm10 10h2v-3h-2v3zm9.83-18.16l-1.79-1.79-1.8 1.79 1.8 1.79 1.79-1.79zM20 13h3v-2h-3v2zM6.76 19.16l-1.8 1.79 1.41 1.41 1.79-1.79-1.4-1.41zM17.24 19.16l1.79 1.79 1.41-1.41-1.79-1.79-1.41 1.41zM12 6a6 6 0 100 12 6 6 0 000-12z"/></svg>'
        // Moon
        : '<svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor" aria-hidden="true"><path d="M21.75 14.5A9.75 9.75 0 1111.5 2.25a8 8 0 0010.25 12.25z"/></svg>';
    }

    function currentTheme(){
      return root.getAttribute('data-theme') === 'light' ? 'light' : 'dark';
    }

    function toggle(){
      const next = currentTheme() === 'light' ? 'dark' : 'light';
      root.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
      setIcon(next);
    }

    setIcon(currentTheme());
    btn.addEventListener('click', toggle);
  })();
</script>

<style>
  .nav{position:sticky;top:0;backdrop-filter:saturate(160%) blur(6px);border-bottom:1px solid var(--border);background:var(--header-bg);z-index:20}
  .nav-inner{display:flex;align-items:center;justify-content:space-between;gap:.75rem;padding:.75rem 0}
  .brand{display:flex;align-items:center;gap:.6rem;font-weight:600}
  .brand .logo{height:28px;width:auto;display:block}
  .links{display:flex;gap:.9rem;align-items:center}
  .links a{color:var(--text);text-decoration:none;padding:.35rem .6rem;border-radius:10px;border:1px solid transparent}
  .links a:hover{border-color:var(--border);background:var(--hover)}
  .theme-toggle{display:inline-flex;align-items:center;justify-content:center;border:1px solid var(--border);background:var(--card);border-radius:999px;padding:.45rem .55rem;cursor:pointer}
  .theme-toggle:hover{background:var(--hover)}
</style>

---
import Layout from "../layouts/Layout.astro";
import Container from "../components/Container.astro";

const ATHLETE_ID = Number(import.meta.env.STRAVA_ATHLETE_ID) || 35369206;
const STRAVA_PROFILE = `https://www.strava.com/athletes/${ATHLETE_ID}`;
---
<Layout title="About | Zach Scholz" description="Background, focus areas, and interests.">
  <Container class="about-tables">
    <!-- Fridge collage -->
    <section class="collage-section">
      <div class="fridge-strip">
        <!-- 1 -->
        <figure class="polaroid p1">
          <div class="card">
            <div class="face front"><img src="/photos/about-1.jpg" alt="" loading="lazy" /></div>
            <div class="face back" aria-hidden="true"><span>Hi üëã</span></div>
          </div>
        </figure>

        <!-- 2 -->
        <figure class="polaroid p2">
          <div class="card">
            <div class="face front"><img src="/photos/about-2.jpg" alt="" loading="lazy" /></div>
            <div class="face back" aria-hidden="true"><span>Trails ‚â´ roads</span></div>
          </div>
        </figure>

        <!-- 3 -->
        <figure class="polaroid p3">
          <div class="card">
            <div class="face front"><img src="/photos/about-3.jpg" alt="" loading="lazy" /></div>
            <div class="face back" aria-hidden="true"><span>Build. Ship. Iterate.</span></div>
          </div>
        </figure>

        <!-- 4: dynamic Strava -->
        <a class="polaroid p4" id="strava-card" href={STRAVA_PROFILE} target="_blank" rel="noopener" aria-label="Latest Strava activity">
          <div class="card">
            <div class="face front">
              <img id="strava-img" src="/photos/about-4.jpg" alt="Latest Strava activity" loading="lazy" />
              <div class="stats" id="strava-stats" hidden></div>
            </div>
            <div class="face back"><span>View on Strava ‚Üó</span></div>
          </div>
        </a>
      </div>
    </section>

    <!-- About Me (2√ó1) -->
    <section class="tbl t2" role="table" aria-label="About Me">
      <div class="cell head first" role="rowheader">About Me</div>
      <div class="cell first" role="cell">
        <p>
          Naval Officer turned builder ‚Äî optimization, data pipelines, and mapping. I design pragmatic tools with measurable
          outcomes, ship quickly, and iterate. Interests: vehicle routing, terrain-aware travel-time, and lean automations for
          finance ops. Outside of work, I‚Äôm usually running or exploring trails.
        </p>
      </div>
    </section>

    <!-- Connect (2√ó1) -->
    <section class="tbl t2 connect" role="table" aria-label="Connect">
      <div class="cell head first" role="rowheader">Connect</div>
      <div class="cell first" role="cell">
        <div class="links">
          <a href="https://www.linkedin.com/in/zachary-scholz/" target="_blank" rel="noopener">LinkedIn</a>
          <a href="mailto:ztscholz86@gmail.com">Email</a>
          <a href={STRAVA_PROFILE} target="_blank" rel="noopener">Strava</a>
        </div>
      </div>
    </section>

    <!-- Work -->
    <section class="tbl t2 work" role="table" aria-label="Work">
      <div class="cell head span-all" role="rowheader">Work</div>
      <div class="cell note" role="cell">Selected roles and highlights.</div>

      <div class="cell item" role="cell">
        <div class="line">
          <img class="logo" src="/icons/Chicago.png" alt="USS Chicago crest" />
          <div class="meta">
            <div class="title">Reactor Control Assistant; Ops & Decommissioning Lead</div>
            <div class="sub">USS Chicago (SSN-721) ¬∑ U.S. Navy</div>
          </div>
          <div class="dates">2018‚Äì2021</div>
        </div>
      </div>

      <div class="cell item" role="cell">
        <div class="line">
          <img class="logo" src="/icons/NAVEUR.png" alt="NAVEUR logo" />
          <div class="meta">
            <div class="title">Staff Officer ‚Äî Analytics & Planning</div>
            <div class="sub">Allied & Fleet HQ ¬∑ Naples, Italy</div>
          </div>
          <div class="dates">2023‚ÄìPresent</div>
        </div>
      </div>
    </section>

    <!-- Side Projects -->
    <section class="tbl t2 projects" role="table" aria-label="Side Projects">
      <div class="cell head span-all" role="rowheader">Side Projects</div>
      <div class="cell note" role="cell">A few things I‚Äôve built ‚Äî click to view details.</div>

      <a class="cell item linkrow" role="cell" href="https://zachscholz.com/coding/FOC/">
        <div class="line">
          <div class="logo ph" aria-hidden="true"></div>
          <div class="meta">
            <div class="title">FOC</div>
            <div class="sub">Unity WebGL tactical sim</div>
          </div>
        </div>
      </a>

      <a class="cell item linkrow" role="cell" href="https://zachscholz.com/coding/tone/">
        <div class="line">
          <img class="logo" src="/icons/Tone.png" alt="Tone icon" />
          <div class="meta">
            <div class="title">Tone</div>
            <div class="sub">Ear / reaction trainer (Unity WebGL)</div>
          </div>
        </div>
      </a>

      <a class="cell item linkrow" role="cell" href="https://zachscholz.com/coding/sheepshead/">
        <div class="line">
          <img class="logo" src="/icons/Sheepshead.png" alt="Sheepshead icon" />
          <div class="meta">
            <div class="title">Sheepshead</div>
            <div class="sub">Trick-taking card game (Unity WebGL)</div>
          </div>
        </div>
      </a>
    </section>
  </Container>

  <!-- Tiny client script to hydrate the Strava photo/stats -->
  <script type="module">
    (async () => {
      try {
        const r = await fetch('/api/strava-latest', { cache: 'no-store' });
        if (!r.ok) return;
        const data = await r.json();
        const img = document.getElementById('strava-img');
        const statsEl = document.getElementById('strava-stats');
        const link = document.getElementById('strava-card');

        if (data.photoUrl && img) img.src = data.photoUrl;
        if (data.activityUrl && link) link.href = data.activityUrl;

        const s = data.stats;
        if (statsEl && s) {
          if (s.isRun && s.distance && s.pace && s.duration) {
            statsEl.innerHTML = `
              <span class="metric">${s.distance}</span>
              <span class="dot">‚Ä¢</span>
              <span class="metric">${s.pace}</span>
              <span class="dot">‚Ä¢</span>
              <span class="metric">${s.duration}</span>
            `;
          } else if (s.duration) {
            statsEl.textContent = s.duration;
          }
          statsEl.hidden = false;
        }
      } catch {}
    })();
  </script>

  <style>
    /* Center the whole page content */
    .about-tables{display:grid;gap:220px;justify-items:center;align-items:start;margin-inline:auto}

    /* Base ‚Äútable‚Äù */
    .tbl{width:min(816px, 78vw);display:grid;background:transparent;border:none;border-radius:0;overflow:visible;margin-inline:auto;justify-self:center}
    .tbl .cell{padding:14px 16px;border-top:none}
    .tbl .cell.first{border-top:none}

    /* Column templates */
    .tbl.t2{grid-template-columns:180px 1fr}
    .tbl.t4{grid-template-columns:180px repeat(3, 1fr)}

    /* Left header column */
    .tbl .head{font-weight:inherit;background:transparent;text-align:right;color:inherit}

    /* Span label across rows in these sections */
    .tbl .head{grid-column:1}
    .tbl .head.span-all{grid-row:1 / -1}
    .tbl.work .head, .tbl.projects .head{grid-row:1 / -1}
    .tbl.work .cell:not(.head), .tbl.projects .cell:not(.head){grid-column:2}

    /* Rows on the right side */
    .tbl .note{color:var(--muted)}
    .tbl .item .line{display:flex;align-items:center;gap:.85rem}
    .tbl .logo{width:56px;height:auto;display:block;border:none;border-radius:0;background:transparent;flex:0 0 56px}
    .tbl .logo.ph{width:56px;height:56px;border:none;border-radius:8px;background:linear-gradient(135deg, color-mix(in oklab, var(--border) 30%, transparent), transparent)}
    .tbl .meta{display:grid;gap:.15rem}
    .tbl .title{line-height:1.15}
    .tbl .sub{color:inherit;font-size:.95rem}
    .tbl .dates{margin-left:auto;white-space:nowrap;color:var(--muted)}

    /* Links */
    .tbl .link, .tbl .linkrow{color:inherit;text-decoration:none}
    .tbl .link:hover, .tbl .linkrow:hover{background:var(--hover)}

    /* Responsive */
    @media (max-width:640px){
      .tbl.t2{grid-template-columns:1fr}
      .tbl.t4{grid-template-columns:1fr 1fr}
      .tbl.work .head, .tbl.projects .head{grid-row:auto}
      .tbl .dates{margin-left:0}
      .tbl .item .line{align-items:flex-start}
    }

    .connect .links{display:flex;gap:1.25rem;flex-wrap:wrap}
    .connect .links a{text-decoration:underline;font-weight:inherit}
    .tbl .head{font-weight:600;background:transparent;text-align:right;color:var(--muted)}

    /* Connect link behavior */
    .connect .links{display:flex;gap:1.25rem;flex-wrap:wrap}
    .connect .links a{font-weight:700;text-decoration:underline}
    .connect .links a:link, .connect .links a:visited{color:inherit}
    .connect .links:hover a{opacity:.45;transition:opacity .15s ease}
    .connect .links a:hover{opacity:1}
    .connect .links a:focus-visible{outline:2px solid var(--border);outline-offset:2px}

    /* Remove bolding explicitly on this page */
    .about-tables strong, .about-tables b{font-weight:inherit}

    /* Fridge collage (no frame; rounded; flip on hover) */
    .fridge-strip{position:relative;width:min(960px,92vw);height:clamp(320px,36vw,420px);margin-inline:auto}
    .fridge-strip .polaroid{position:absolute;top:0;width:clamp(160px,22vw,220px);aspect-ratio:3/4;display:block;text-decoration:none}
    .fridge-strip .polaroid .card{position:relative;width:100%;height:100%;border-radius:14px;transform-style:preserve-3d;transition:transform .6s ease;box-shadow:0 8px 24px rgba(0,0,0,.18);overflow:hidden}
    .fridge-strip .polaroid .face{position:absolute;inset:0;backface-visibility:hidden;border-radius:inherit;display:block}
    .fridge-strip .polaroid .front img{width:100%;height:100%;object-fit:cover;display:block;border-radius:inherit}
    .fridge-strip .polaroid .back{display:flex;align-items:center;justify-content:center;background:var(--card);color:var(--text);transform:rotateY(180deg);font-weight:600}
    .fridge-strip .polaroid:hover .card{transform:rotateY(180deg)}
    .fridge-strip .polaroid:focus-visible .card{outline:2px solid var(--border);outline-offset:2px}

    /* Positions/rotation */
    .fridge-strip .p1{left:0%;transform:rotate(-3.5deg);z-index:3}
    .fridge-strip .p2{left:calc(25% - 20px);transform:rotate(2.5deg);z-index:2}
    .fridge-strip .p3{left:calc(50% - 40px);transform:rotate(-1.5deg);z-index:4}
    .fridge-strip .p4{left:calc(75% - 60px);transform:rotate(3deg);z-index:1}

    /* Drop-in animation */
    .fridge-strip .polaroid{opacity:0;animation:dropIn .35s ease-out forwards}
    .fridge-strip .p1{animation-delay:.05s}
    .fridge-strip .p2{animation-delay:.12s}
    .fridge-strip .p3{animation-delay:.19s}
    .fridge-strip .p4{animation-delay:.26s}
    @keyframes dropIn{to{opacity:1}}

    /* Hide collage on narrow screens */
    @media (max-width:800px){.fridge-strip{display:none}}
    .collage-section{width:100%;display:flex;justify-content:center;isolation:isolate}

    /* Stats badge (bottom-right) */
    .fridge-strip .stats{
      position:absolute;right:10px;bottom:10px;
      display:flex;align-items:center;gap:.35rem;flex-wrap:wrap;
      background:rgba(0,0,0,.55);
      color:#fff;font-weight:600;
      padding:.4rem .6rem;border-radius:10px;
      backdrop-filter:blur(2px);
      font-size:.9rem;line-height:1;
    }
    .fridge-strip .stats .dot{opacity:.6}
    .fridge-strip .stats .metric{white-space:nowrap}
  </style>
</Layout>
